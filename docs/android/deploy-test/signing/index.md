---
title: Подписывание пакета приложения для Android
description: Сведения о подписывании пакета приложения для Android (APK) для публикации
ms.prod: xamarin
ms.assetid: 8E3EFBB2-F8AD-C126-5F32-7FD140791E53
ms.technology: xamarin-android
author: davidortinau
ms.author: daortin
ms.date: 07/02/2018
ms.openlocfilehash: 07c20be730d73b080d99b2fecb88b26115c37bc2
ms.sourcegitcommit: 63029dd7ea4edb707a53ea936ddbee684a926204
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/20/2021
ms.locfileid: "98609031"
---
# <a name="signing-the-android-application-package"></a>Подписывание пакета приложения для Android

В разделе [Подготовка приложения к выпуску](~/android/deploy-test/release-prep/index.md) для сборки и архивации приложения для последующего подписывания и публикации использовался **Диспетчер архивов**. Из этого раздела вы узнаете, как создать удостоверение подписывания Android, как создать новый сертификат подписи для приложений Android и как опубликовать заархивированное приложение *напрямую* на диск. Полученный неопубликованный APK-файл можно установить на устройства с Android, минуя магазин приложений.

# <a name="visual-studio"></a>[Visual Studio](#tab/windows)

В разделе [Архивирование для публикации](~/android/deploy-test/release-prep/index.md#archive) в диалоговом окне **Канал распространения** предлагается два варианта распространения. Выберите **Прямое**:

[![Диалоговое окно "Канал распространения"](images/vs/01-distribution-channel-sml.png)](images/vs/01-distribution-channel.png#lightbox)

# <a name="visual-studio-for-mac"></a>[Visual Studio для Mac](#tab/macos)

В разделе [Архивирование для публикации](~/android/deploy-test/release-prep/index.md#archive) в диалоговом окне **Подписать и распространить...** предлагается два варианта распространения. Выберите **Прямое** и нажмите **Далее**:

[![Диалоговое окно "Подписывание и распространение", выбор канала распространения Android.](images/xs/01-select-ad-hoc-sml.png)](images/xs/01-select-ad-hoc.png#lightbox)

-----

<a name="newcertvs"></a>
<a name="newcert"></a>
<a name="newcertxs"></a>

## <a name="create-a-new-certificate"></a>Создание нового сертификата

# <a name="visual-studio"></a>[Visual Studio](#tab/windows)

После выбора **Прямое** Visual Studio откроет страницу **Удостоверение подписывания** диалогового окна, как это показано на следующем рисунке. Для публикации .APK-файла его обязательно нужно подписать ключом подписи (также называемым сертификатом).

Можно использовать существующий сертификат, нажав кнопку **Импорт**, и затем продолжив с пункта [Подписывание пакета APK](#sign-the-apk). Если у вас еще нет сертификата, нажмите кнопку **+** для создания нового сертификата:

[![Удостоверение подписывания при прямой публикации](images/vs/02-ad-hoc-signing-identity-vs-sml.png)](images/vs/02-ad-hoc-signing-identity-vs.png#lightbox)

Появится диалоговое окно **Создание хранилища ключей Android**. Создайте при помощи этого окна новый сертификат подписи, который затем можно будет использовать для подписывания приложений Android. Введите необходимые сведения в этом диалоговом окне (выделено красным), как это показано на рисунке:

[![Диалоговое окно "Создание хранилища ключей Android"](images/vs/03-create-android-key-store-vs-sml.png)](images/vs/03-create-android-key-store-vs.png#lightbox)

На следующем рисунке приведен пример сведений, которые необходимо ввести в этом окне. Нажмите **Создать** для создания нового сертификата:

[![Создание нового сертификата](images/vs/04-key-store-example-vs-sml.png)](images/vs/04-key-store-example-vs.png#lightbox)

Полученное хранилище ключей находится в следующем расположении:

**C:\\Users\\*Имя_пользователя*\\AppData\\Local\\Xamarin\\Mono for Android\\Keystore\\*Псевдоним*\\*Псевдоним*.keystore**

Например, при использовании **chimp** в качестве псевдонима вышеуказанные шаги создадут ключ подписи в следующем расположении:

**C:\\Users\\*ИМЯ_ПОЛЬЗОВАТЕЛЯ*\\AppData\\Local\\Xamarin\\Mono for Android\\Keystore\\chimp\\chimp.keystore**

> [!IMPORTANT]
> Папка AppData по умолчанию скрыта, и для доступа к ней вам, возможно, потребуется отобразить ее.
>
> Кроме того, обязательно сохраните резервную копию файла полученного хранилища ключей и пароль в безопасном месте (оно не указано в этом руководстве). Если вы потеряете ваш файл хранилища ключей (например, если вы сменили компьютер или переустановили Windows), то вы не сможете подписать приложение тем же сертификатом, что и предыдущие версии.

Подробные сведения о хранилище сертификата см. в разделе [Отображение MD5 и SHA1 сигнатур хранилища ключей](~/android/deploy-test/signing/keystore-signature.md).

# <a name="visual-studio-for-mac"></a>[Visual Studio для Mac](#tab/macos)

После нажатия кнопки **Прямое** Visual Studio для Mac откроет диалоговое окно **Удостоверение подписывания Android**. Для публикации .APK-файла его обязательно нужно подписать ключом подписи (также называемым сертификатом). Если сертификат уже существует, то для его импорта нажмите кнопку **Импорт существующего ключа** и перейдите к разделу [Подписывание пакета APK](#sign-the-apk) В ином случае нажмите кнопку **Создать новый ключ** для создания нового сертификата:

[![Диалоговое окно "Удостоверение подписывания Android"](images/xs/02-android-signing-identity-sml.png)](images/xs/02-android-signing-identity.png#lightbox)

Диалоговое окно **Создание нового сертификата** используется для создания нового сертификата подписи, который можно использовать для подписания приложений Android. После ввода всех необходимых сведений нажмите кнопку **OK**:

[![Диалоговое окно "Создание нового сертификата"](images/xs/03-create-new-certificate-sml.png)](images/xs/03-create-new-certificate.png#lightbox)

Полученное хранилище ключей находится в следующем расположении:

**~/Library/Developer/Xamarin/Keystore/alias/alias.keystore**

Например, вышеуказанные шаги создадут новый ключ подписи в следующем расположении:

**~/Library/Developer/Xamarin/Keystore/chimp/chimp.keystore**

> [!NOTE]
> Обязательно сохраните резервную копию файла полученного хранилища ключей и пароль в безопасном месте &ndash; оно не указано в этом руководстве. Если вы потеряете файл хранилища ключей (например, сменили компьютер или переустановили macOS), вы не сможете подписать приложение тем же сертификатом, что и предыдущие версии.

Подробные сведения о хранилище сертификата см. в разделе [Отображение MD5 и SHA1 сигнатур хранилища ключей](~/android/deploy-test/signing/keystore-signature.md).

-----

## <a name="sign-the-apk"></a>Подписывание пакета APK

# <a name="visual-studio"></a>[Visual Studio](#tab/windows)

При нажатии кнопки **Создать** новое хранилище ключей (содержащее новый сертификат) будет сохранено и отобразится в списке **Удостоверение подписывания**, как это показано на следующем рисунке. Для публикации приложения в Google Play нажмите **Отмена** и перейдите к разделу [Публикация в Google Play](~/android/deploy-test/publishing/publishing-to-google-play/index.md).
Для публикации *напрямую* выберите удостоверение подписывания и нажмите **Сохранить как**, чтобы опубликовать приложение для независимого распространения. Например, на приведенном ниже рисунке выбрано созданное ранее удостоверение подписывания **chimp**:

[![Пример удостоверения подписывания](images/vs/05-save-as-vs-sml.png)](images/vs/05-save-as-vs.png#lightbox)

Затем **Диспетчер архивов** отобразит ход выполнения операции. После завершения процесса публикации для выбора места сохранения сформированного .APK-файла откроется диалоговое окно **Сохранить как**:

[![Диалоговое окно "Сохранить как"](images/vs/06-save-as-dialog-vs-sml.png)](images/vs/06-save-as-dialog-vs.png#lightbox)

Перейдите в желаемое расположение для сохранения и нажмите **Сохранить**. Если неизвестен пароль ключа, откроется диалоговое окно **Пароль для подписывания** для ввода пароля выбранного сертификата:

[![Диалоговое окно "Пароль для подписывания"](images/vs/07-signing-password-vs-sml.png)](images/vs/07-signing-password-vs.png#lightbox)

После подписания файла щелкните **Открытое распространение**:

[![Кнопка "Открытое распространение"](images/vs/08-open-distribution-sml.png)](images/vs/08-open-distribution.png#lightbox)

В результате проводник Windows откроет папку, содержащую сформированный APK-файл. На этом этапе Visual Studio завершает компиляцию приложения Xamarin.Android в APK-файл, готовый к распространению.
На рисунке ниже изображен пример готового к публикации приложения **MyApp.MyApp.apk**:

[![APK-файл в проводнике Windows](images/vs/09-generated-app-vs-sml.png)](images/vs/09-generated-app-vs.png#lightbox)

# <a name="visual-studio-for-mac"></a>[Visual Studio для Mac](#tab/macos)

Как мы видим, новый сертификат был добавлен в хранилище ключей. Для публикации приложения в Google Play нажмите **Отмена** и перейдите к разделу [Публикация в Google Play](~/android/deploy-test/publishing/publishing-to-google-play/index.md).
В противоположном случае нажмите **Далее** для публикации приложения *напрямую* (для независимого распространения), как это показано в следующем примере:

[![Диалоговое окно "Подписывание и распространение", удостоверение подписывания Android.](images/xs/04-select-identity-sml.png)](images/xs/04-select-identity.png#lightbox)

Диалоговое окно **Опубликовать напрямую** перед публикацией отображает сводку по подписанному приложению. Проверьте правильность следующих сведений и нажмите **Опубликовать**.

[![Диалоговое окно "Опубликовать напрямую"](images/xs/05-publish-ad-hoc-sml.png)](images/xs/05-publish-ad-hoc.png#lightbox)

С помощью диалогового окна **Выходной APK-файл** укажите путь для сохранения файла. Нажмите кнопку **Сохранить**.

![Диалоговое окно "Выходной APK-файл"](images/xs/06-output-apk-file.png)

Затем введите пароль сертификата (пароль, который был указан в диалоговом окне **Создание нового сертификата**) и нажмите **OK**:

![Ввод пароля сертификата](images/xs/07-signing-certificate.png)

APK-файл подписан сертификатом и сохранен по указанному пути. Нажмите **Показать в Finder**:

[![Диалоговое окно "Публикация выполнена"](images/xs/08-app-is-ready-sml.png)](images/xs/08-app-is-ready.png#lightbox)

В результате откроется Finder с расположением подписанного APK-файла:

[![APK-файл в Finder](images/xs/09-show-in-finder-sml.png)](images/xs/09-show-in-finder.png#lightbox)

APK-файл готов к копированию из Finder в место назначения. Перед распространением рекомендуется установить APK-файл на устройство с Android и проверить работоспособность приложения. Дополнительные сведения о *прямой публикации* APK-файлов см. в разделе [Независимая публикация](~/android/deploy-test/publishing/publishing-independently.md).

-----

## <a name="next-steps"></a>Следующие шаги

После подписывания пакета приложения для выпуска его необходимо опубликовать. Следующие разделы описывают несколько способов публикации приложения.


## <a name="related-links"></a>Связанные ссылки

- [Создание хранилища ключей Android](https://developer.android.com/studio/publish/app-signing#generate-key)
