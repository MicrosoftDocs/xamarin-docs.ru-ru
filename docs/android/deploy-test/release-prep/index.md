---
title: Подготовка приложения к выпуску
ms.prod: xamarin
ms.assetid: 9C8145B3-FCF1-4649-8C6A-49672DDA4159
ms.technology: xamarin-android
author: davidortinau
ms.author: daortin
ms.date: 03/21/2018
ms.openlocfilehash: e3003aa06f310e9dee962ff6f4ad12c2de9263e8
ms.sourcegitcommit: d1980b2251999224e71c1289e4b4097595b7e261
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/29/2020
ms.locfileid: "92928624"
---
# <a name="preparing-an-application-for-release"></a>Подготовка приложения к выпуску

После создания и тестирования кода приложения необходимо подготовить пакет для распространения. Первой задачей при подготовке этого пакета является сборка приложения для выпуска, в основном предполагающая установку некоторых атрибутов приложения.

Чтобы построить приложение для выпуска, выполните следующие действия:

- **[Указание значка приложения](#Specify_the_Application_Icon)**  — для каждого приложения Xamarin.Android необходимо указать значок. С технической точки зрения это не обязательно, однако многие продавцы, например Google Play, требуют, чтобы у приложения был свой значок.

- **[Настройка управления версиями приложения](#Versioning)**  — на этом шаге требуется инициализировать или обновить сведения об управлении версиями. Это важно для эффективного обновления приложения в будущем и для того, чтобы пользователи могли знать, какая версия приложения у них установлена.

- **[Сокращение объема пакета APK](#shrink_apk)**  — размер конечного пакета APK можно значительно уменьшить, используя компоновщик Xamarin.Android для управляемого кода и ProGuard для байт-кода Java.

- **[Защита приложения](#protect_app)**  — запретите пользователям или злоумышленникам выполнять отладку, незаконное изменение, или реконструирование приложения, отключив отладку, маскируя управляемый код, добавляя возможности защиты от отладки и незаконного изменения, а также используя компиляцию в машинном коде.

- **[Настройка свойств упаковки](#Set_Packaging_Properties)**  — свойства упаковки определяют, как будет создаваться пакет приложения для Android (APK). Этот шаг позволяет оптимизировать пакет APK, защитить его ресурс и при необходимости разбить его на модули. Кроме того, вы можете предоставить пользователям пакет приложений Android, оптимизированный для их устройств.

- **[Компиляция](#Compile)**  — на этом шаге выполняется компиляция кода и ресурсов для построения в режиме выпуска.

- **[Архивация для публикации](#archive)**  — на этом шаге выполняется построение приложения и его архивация для последующего подписывания и публикации.

Далее эти действия описываются более подробно.

<a name="Specify_the_Application_Icon"></a>

## <a name="specify-the-application-icon"></a>Указание значка приложения

Настоятельно рекомендуется указывать значок приложения для каждого проекта Xamarin.Android. Некоторые магазины приложений не допускают публикацию приложений Android без значков. Указать значок приложения для проекта Xamarin.Android можно с помощью свойства `Icon` атрибута `Application`.

<!-- markdownlint-disable MD001 -->

# <a name="visual-studio"></a>[Visual Studio](#tab/windows)

В Visual Studio 2017 и более поздних версиях значок приложения можно указать в разделе **Манифест Android** в окне **Свойства** проекта, как показано на следующем снимке экрана:

[![Указание значка приложения](images/vs/01-application-icon-sml.png)](images/vs/01-application-icon.png#lightbox)

# <a name="visual-studio-for-mac"></a>[Visual Studio для Mac](#tab/macos)

В Visual Studio для Mac значок приложения также можно указать в разделе **Приложение Android** в окне **Параметры проекта** , как показано на следующем снимке экрана:

[![Указание значка приложения](images/xs/01-application-icon-sml.png)](images/xs/01-application-icon.png#lightbox)

-----

В этих примерах в `@drawable/icon` добавлена ссылка на файл значка по пути **Resources/drawable/icon.png** (обратите внимание, что расширение **.png** не включено в имя ресурса). Этот атрибут также объявляется в файле **Properties\AssemblyInfo.cs** , как показано в следующем примере:

```csharp
[assembly: Application(Icon = "@drawable/icon")]
```

Как правило, `using Android.App` объявляется в верхней части **AssemblyInfo.cs** (для пространства имен атрибута `Android.App` задается значение `Application`). Но, возможно, потребуется добавить инструкцию `using`, если ее еще нет.

<a name="Versioning"></a>

## <a name="version-the-application"></a>Настройка управления версиями приложения

Управление версиями имеет важное значение для обслуживания и распространения приложений Android. Без какого то ни было механизма управления версиями сложно определить необходимость и способ обновления приложения. Для упрощения управления версиями Android распознает два различных типа сведений:

- **Номер версии**  — целочисленное значение (для внутреннего использования Android и приложением), представляющее версию приложения. Для большинства приложений номер версии начинается с 1, и с каждой сборкой это значение увеличивается. Это значение не имеет связи или сопоставления с атрибутом имени версии (см. ниже). Пользователи не должны видеть это значение в приложениях и службах публикации. Это значение хранится в файле **AndroidManifest.xml** в виде `android:versionCode`.

- **Имя версии**  — строка, используемая только для передачи пользователю информации о версии приложения (как установлено на конкретном устройстве). Пользователи должны видеть имя версии. Оно также должно отображаться в Google Play. Android не использует эту строку для внутренних целей. Имя версии может быть любым строковым значением, упрощающим идентификацию сборки, установленной на устройстве пользователя. Это значение хранится в файле **AndroidManifest.xml** в виде `android:versionName`.

# <a name="visual-studio"></a>[Visual Studio](#tab/windows)

В Visual Studio эти значения можно задать в разделе **Манифест Android** в окне **Свойства** проекта, как показано на следующем снимке экрана:

[![Настройка номера версии](images/vs/02-versioning-sml.png)](images/vs/02-versioning.png#lightbox)

# <a name="visual-studio-for-mac"></a>[Visual Studio для Mac](#tab/macos)

Эти значения можно задать в разделе **Сборка > Приложение Android** в окне **Параметры проекта** , как показано на следующем снимке экрана:

[![Настройка номера версии](images/xs/02-versioning-sml.png)](images/xs/02-versioning.png#lightbox)

-----

<a name="shrink_apk"></a>

## <a name="shrink-the-apk"></a>Сокращение объема пакета APK

Размер пакетов APK Xamarin.Android можно уменьшить, используя компоновщик Xamarin.Android, который удаляет ненужный *управляемый* код, и средство *ProGuard* из пакета SDK для Android, которое удаляет неиспользуемый *байт-код Java*. В процессе сборки сначала используется компоновщик Xamarin.Android для оптимизации управляемого кода (C#), а затем применяется ProGuard (если он включен) для оптимизации пакета APK на уровне байт-кода Java.

### <a name="configure-the-linker"></a>Настройка компоновщика

Режим "Выпуск" отключает общую среду выполнения и включает компоновку, поэтому приложение поставляет только части Xamarin.Android, необходимые во время выполнения. С помощью статического анализа *компоновщик* в Xamarin.Android определяет, какие сборки, типы и члены типов использует или указывает приложение Xamarin.Android. Затем компоновщик удаляет все неиспользуемые (или неуказанные) сборки, типы и члены. Это может привести к значительному сокращению размера пакета. Рассмотрим пример [HelloWorld](~/android/deploy-test/linker.md), когда окончательный размер пакета APK уменьшается на 83 %:

- Конфигурация: отсутствует &ndash; размер Xamarin.Android 4.2.5 = 17,4 МБ.

- Конфигурация: только сборки SDK &ndash; размер Xamarin.Android 4.2.5 = 3,0 МБ.

# <a name="visual-studio"></a>[Visual Studio](#tab/windows)

Параметры компоновщика можно задать в разделе **Параметры Android** в окне **Свойства** проекта:

[![Параметры компоновщика](images/vs/03-linking-sml.png)](images/vs/03-linking.png#lightbox)

В раскрывающемся меню **Компоновка** можно настроить следующие параметры компоновщика:

- **Нет**  — компоновщик отключается, и компоновка не выполняется.

- **Только сборки пакета SDK**  — в этом случае компонуются только те сборки, которые [необходимы для Xamarin.Android](~/cross-platform/internals/available-assemblies.md).
    Другие сборки не компонуются.

- **Сборки пакета SDK и пользователя**  — в этом случае компонуются все сборки, используемые приложением, а не только необходимые для Xamarin.Android.

# <a name="visual-studio-for-mac"></a>[Visual Studio для Mac](#tab/macos)

Параметры компоновщика можно настроить на вкладке **Компоновщик** в разделе **Сборка Android** окна **Параметры проекта** , как показано на следующем снимке экрана:

[![Параметры компоновщика](images/xs/03-linking-sml.png)](images/xs/03-linking.png#lightbox)

Доступны следующие параметры компоновщика:

- **Не компоновать**  — компоновщик отключается, и компоновка не выполняется.

- **Компоновать только сборки пакета SDK**  — в этом случае компонуются только те сборки, которые [необходимы для Xamarin.Android](~/cross-platform/internals/available-assemblies.md). Другие сборки не компонуются.

- **Компоновать все сборки**  — в этом случае компонуются все сборки, используемые приложением, а не только необходимые для Xamarin.Android.

-----

При компоновке могут возникать нежелательные побочные эффекты, поэтому важно повторно протестировать приложение в режиме выпуска на физическом устройстве.

### <a name="proguard"></a>ProGuard

*ProGuard* является средством пакета SDK для Android, которое компонует и скрывает код Java.
ProGuard обычно используется для создания небольших приложений за счет сокращения размера больших включенных библиотек (например, служб Google Play) в пакете APK. ProGuard удаляет неиспользуемый байт-код Java, что приводит к уменьшению размера результирующего приложения. Например, при использовании ProGuard в небольших приложениях Xamarin.Android размер обычно уменьшается на 24 % &ndash; при использовании ProGuard в крупных приложениях с несколькими зависимостями библиотек показатель сокращения еще выше.

ProGuard не является альтернативой компоновщику Xamarin.Android. Компоновщик Xamarin.Android связывает *управляемый* код, а ProGuard — байт-код Java. В процессе сборки сначала используется компоновщик Xamarin.Android для оптимизации управляемого кода (C#) в приложении, а затем применяется ProGuard (если он включен) для оптимизации пакета APK на уровне байт-код Java.

Если параметр **Включить ProGuard** включен, Xamarin.Android запустит ProGuard в итоговом пакете APK. Во время сборки ProGuard создает и использует файл конфигурации ProGuard. Xamarin.Android также поддерживает настраиваемые действия сборки *ProguardConfiguration*. В проект можно добавить настраиваемый файл конфигурации ProGuard, щелкнуть его правой кнопкой мыши и выбрать в качестве действия сборки, как показано в следующем примере:

# <a name="visual-studio"></a>[Visual Studio](#tab/windows)

[![Действие построения Proguard](images/vs/05-proguard-build-action-sml.png)](images/vs/05-proguard-build-action.png#lightbox)

# <a name="visual-studio-for-mac"></a>[Visual Studio для Mac](#tab/macos)

[![Действие построения Proguard](images/xs/05-proguard-build-action-sml.png)](images/xs/05-proguard-build-action.png#lightbox)

-----

По умолчанию средство ProGuard отключено. Параметр **Включить ProGuard** доступен, только если для проекта задан режим **Выпуск**. Все действия сборки ProGuard игнорируются до тех пор, пока не будет включен параметр **Включить ProGuard**. Конфигурация Xamarin.Android ProGuard не скрывает пакет APK. Скрытие невозможно включить даже с помощью настраиваемых файлов конфигурации. Сведения об использовании скрытия см. в разделе [Защита приложения с помощью Dotfuscator](~/android/deploy-test/release-prep/index.md#dotfuscator).

Дополнительные сведения об использовании средства ProGuard см. в разделе [ProGuard](~/android/deploy-test/release-prep/proguard.md).

<a name="protect_app"></a>

## <a name="protect-the-application"></a>Защита приложения

<a name="Disable_Debugging"></a>

### <a name="disable-debugging"></a>Выключение отладки

Во время разработки приложения Android отладка выполняется с использованием *протокола Java Debug Wire* (JDWP). Это технология, которая позволяет таким средствам, как **adb** , взаимодействовать с виртуальной машиной Java в целях отладки. Протокол JDWP включен по умолчанию для сборок отладки приложения Xamarin.Android. Несмотря на то, что протокол JDWP имеет важное значение во время разработки, он может представлять угрозу безопасности для выпускаемых приложений.

> [!IMPORTANT]
> В выпускаемом приложении следует всегда отключать состояние отладки, так как в противном случае можно (через JDWP) получить полный доступ к процессу Java и выполнить произвольный код в контексте приложения.

Манифест Android содержит атрибут `android:debuggable`, который контролирует возможность отладки приложения. Атрибуту `android:debuggable` рекомендуется задать значение `false`. Проще всего это сделать путем добавления инструкции условной компиляции в файл **AssemblyInfo.cs** :

```csharp
#if DEBUG
[assembly: Application(Debuggable=true)]
#else
[assembly: Application(Debuggable=false)]
#endif
```

Обратите внимание, что сборки отладки автоматически задают некоторые разрешения для упрощения отладки (например, **Internet** и **ReadExternalStorage** ). Однако сборки выпуска используют только разрешения, настроенные явным образом. Если обнаружится, что при переключении на сборку выпуска приложение теряет разрешение, которое было доступно в сборке отладки, убедитесь, что это разрешение включено явным образом в списке **Необходимые разрешения** , как описано в разделе [Разрешения](~/android/app-fundamentals/permissions.md).

<a name="dotfuscator" id="dotfuscator"></a>

### <a name="application-protection-with-dotfuscator"></a>Защита приложений с использованием Dotfuscator

# <a name="visual-studio"></a>[Visual Studio](#tab/windows)

Даже если [отладка выключена](#Disable_Debugging), злоумышленники по-прежнему могут выполнять повторную упаковку пакета, а также добавлять и удалять параметры конфигурации или разрешения. Это позволяет реконструировать приложение, выполнять его отладку или незаконно изменять.
[Dotfuscator Community Edition (CE)](https://www.preemptive.com/products/dotfuscator/overview) может использоваться для маскировки управляемого кода и вставки кода обнаружения состояния безопасности среды выполнения в приложение Xamarin.Android на этапе построения, чтобы обнаружить запуск приложения на устройстве с административным доступом и отреагировать соответствующим образом.

Dotfuscator CE входит в состав Visual Studio 2017.
Чтобы использовать Dotfuscator, выберите **Сервис > Защита PreEmptive — Dotfuscator**.

Дополнительные сведения о настройке Dotfuscator CE см. в разделе [Использование Dotfuscator Community Edition с Xamarin](https://www.preemptive.com/obfuscating-xamarin-with-dotfuscator).
После настройки Dotfuscator CE будет автоматически защищать каждую создаваемую сборку.

# <a name="visual-studio-for-mac"></a>[Visual Studio для Mac](#tab/macos)

Даже если [отладка выключена](#Disable_Debugging), злоумышленники по-прежнему могут выполнять повторную упаковку пакета, а также добавлять и удалять параметры конфигурации или разрешения. Это позволяет реконструировать приложение, выполнять его отладку или незаконно изменять.
Несмотря на то, что это средство не поддерживает Visual Studio для Mac, вы можете использовать [Dotfuscator Community Edition (CE)](https://www.preemptive.com/products/dotfuscator/overview) с Visual Studio для маскировки управляемого кода и вставки кода обнаружения состояния безопасности среды выполнения в приложение Xamarin.Android на этапе построения, чтобы обнаружить запуск приложения на устройстве с административным доступом и отреагировать соответствующим образом.

Дополнительные сведения о настройке Dotfuscator CE см. в разделе [Использование Dotfuscator Community Edition с Xamarin](https://www.preemptive.com/obfuscating-xamarin-with-dotfuscator).
После настройки Dotfuscator CE будет автоматически защищать каждую создаваемую сборку.

-----

<a name="bundle"></a>

### <a name="bundle-assemblies-into-native-code"></a>Объединение сборок в машинный код

Если этот параметр включен, сборки объединяются в общую библиотеку машинного кода. Это позволяет сжимать сборки и получать файлы `.apk` меньшего размера. Сжатие сборок также обеспечивает *минимальную* обфускацию, на которую не следует полагаться.

Этот параметр требует наличия лицензии Enterprise и доступен только при отключении параметра **Использовать Fast Deployment**. Параметр **Объединить сборки в машинный код** отключен по умолчанию.

Обратите внимание, что параметр **Объединить в машинный код** *не* означает, что сборки компилируются в машинный код. Параметр [**Компиляция AOT**](#aot) нельзя использовать для компиляции сборок в машинный код.

<a name="aot"></a>

### <a name="aot-compilation"></a>Компиляция AOT

Параметр **Компиляция AOT** (на странице [Свойства упаковки](#Set_Packaging_Properties) страницы) активирует компиляцию AOT (Ahead-of-Time) сборок. Если этот параметр включен, издержки при запуске JIT (Just In Time) уменьшаются путем предварительной компиляции сборки до времени выполнения. Итоговый машинный код включается в пакет APK вместе с нескомпилированными сборками. Это приводит к сокращению времени запуска приложения, но за счет незначительного увеличения размеров APK.

Для использования параметра **Компиляция AOT** требуется лицензия Enterprise или более высокого уровня. Параметр **Компиляция AOT** доступен, только если проект настроен для режима "Выпуск". По умолчанию параметр отключен. Дополнительные сведения о компиляции AOT см. в статье об [AOT](https://www.mono-project.com/docs/advanced/aot/).

#### <a name="llvm-optimizing-compiler"></a>Оптимизирующий компилятор LLVM

_Оптимизирующий компилятор LLVM_ создает быстрее скомпилированный код небольшого размера и преобразует AOT-скомпилированные сборки в машинный код, однако это происходит за счет увеличения времени сборки. Компилятор LLVM отключен по умолчанию. Для использования компилятора LLVM сначала необходимо включить параметр **Компиляция AOT** на странице [Свойства упаковки](#Set_Packaging_Properties).

> [!NOTE]
> Для использования параметра **Оптимизирующий компилятор LLVM** требуется корпоративная лицензия.  

<a name="Set_Packaging_Properties"></a>

## <a name="set-packaging-properties"></a>Настройка свойств упаковки

# <a name="visual-studio"></a>[Visual Studio](#tab/windows)

Свойства упаковки можно задать в разделе **Параметры Android** в окне **Свойства** проекта, как показано на следующем снимке экрана:

[![Свойства упаковки](images/vs/04-packaging-sml.png)](images/vs/04-packaging.png#lightbox)

# <a name="visual-studio-for-mac"></a>[Visual Studio для Mac](#tab/macos)

Свойства упаковки можно задать в разделе **Параметры проекта** , как показано на следующем снимке экрана:

[![Свойства упаковки](images/xs/04-packaging-sml.png)](images/xs/04-packaging.png#lightbox)

-----

Многие из этих свойств, например **Использовать общую среду выполнения** и **Использовать Fast Deployment** , предназначены для режима отладки. Тем не менее для режима выпуска приложения предусмотрены другие настройки, которые определяют, как приложение [оптимизируется по размеру и скорости выполнения](#shrink_apk), как обеспечивается [защита приложения от незаконного использования](#protect_app) и как следует упаковывать приложения для поддержки различных архитектур и ограничений по размеру.

### <a name="specify-supported-architectures"></a>Указание поддерживаемых архитектур

При подготовке приложения Xamarin.Android к выпуску необходимо указать поддерживаемые архитектуры процессоров. Один APK-файл может содержать код для нескольких различных архитектур. О поддержке нескольких архитектур процессоров см. раздел [Архитектуры ЦП](~/android/app-fundamentals/cpu-architectures.md).

### <a name="generate-one-package-apk-per-selected-abi"></a>Создание одного пакета (APK) для каждого выбранного ABI

Если этот параметр включен, один пакет APK создается для каждого поддерживаемого ABI (выбираемого на вкладке **Дополнительно** , как описано в разделе [Архитектуры ЦП](~/android/app-fundamentals/cpu-architectures.md)), а не один большой пакет APK для всех поддерживаемых ABI. Этот параметр доступен, только если проект настроен для режима "Выпуск". По умолчанию параметр отключен.

### <a name="multi-dex"></a>Multi-DEX

Если параметр **Включить Multi-Dex** включен, инструменты Android SDK Tools используются для преодоления предела в 65 тысяч методов для формата **DEX-файлов**. Ограничение в 65 тысяч методов основано на количестве методов Java, на которые _ссылается_ приложение (включая методы во всех библиотеках, от которых зависит приложение), &ndash; оно не основано на количестве методов, _записанных в исходный код_. Если приложение определяет лишь несколько методов, но использует много методов (или большие библиотеки), вероятно, что предел в 65 тысяч будет превышен.

Бывает, что приложение не использует каждый метод в каждой ссылаемой библиотеке. Поэтому можно воспользоваться таким средством, как ProGuard (см. выше), чтобы удалить неиспользуемые методы из кода. Параметр **Включить Multi-Dex** рекомендуется включать только в случае крайней необходимости, т. е. приложение по-прежнему ссылается на более чем 65 тысяч методов Java даже после использования ProGuard.

Дополнительные сведения о Multi-Dex см. в статье о [настройке приложений с более чем 64 тысячами методов](https://developer.android.com/tools/building/multidex.html).

### <a name="android-app-bundles"></a>Пакеты приложений Android

Пакеты приложений отличаются от пакетов APK тем, что их невозможно развернуть непосредственно на устройстве. Скорее, это формат, предназначенный для отправки вместе со всеми ресурсами и скомпилированным кодом. После отправки подписанного пакета приложений в магазине Google Play будет иметься все необходимое для создания и подписывания пакетов APK вашего приложения и их динамической доставки пользователям.

Чтобы включить поддержку пакетов приложений Android, в параметрах проекта Android выберите для свойства **Формат пакета Android** значение `bundle`. Прежде чем это сделать, убедитесь, что проект настроен на использование конфигурации `Release`, поскольку пакеты приложений предназначены только для пакетов выпуска.

Теперь можно создать пакет приложений, выполнив [поток архивации](#archive). Будет создан пакет приложений для вашего приложения.

Дополнительные сведения о пакетах приложений Android см. в разделе [Пакеты приложений Android](https://developer.android.com/guide/app-bundle/).

<a name="Compile"></a>

## <a name="compile"></a>Компилятор

# <a name="visual-studio"></a>[Visual Studio](#tab/windows)

После завершения всех описываемых выше действий приложение будет готово для компиляции. Выберите **Сборка > Перестроить решение** , чтобы убедиться в успешном построении приложения в режиме выпуска. Обратите внимание, что на этом шаге еще не создается пакет APK.

В разделе [Подписывание пакета приложения](~/android/deploy-test/signing/index.md) более подробно рассматриваются вопросы упаковки и подписывания.

# <a name="visual-studio-for-mac"></a>[Visual Studio для Mac](#tab/macos)

После выполнения всех описываемых выше действий скомпилируйте приложение (выберите **Сборка > Собрать все** ), чтобы убедиться в успешном построении приложения в режиме выпуска. Обратите внимание, что на этом шаге еще не создается пакет APK.

-----

<a name="archive"></a>

## <a name="archive-for-publishing"></a>Архивация для публикации

# <a name="visual-studio"></a>[Visual Studio](#tab/windows)

Чтобы начать процесс публикации, щелкните правой кнопкой мыши проект в **обозревателе решений** и выберите команду контекстного меню **Архивировать** :

[![Архивация приложения](images/vs/07-archive-for-publishing-sml.png)](images/vs/07-archive-for-publishing.png#lightbox)

Команда **Архивировать** запускает **диспетчер архивов** и начинает процесс архивации пакета приложения, как показано на следующем снимке экрана:

[![Диспетчер архивов](images/vs/08-archive-manager-sml.png)](images/vs/08-archive-manager.png#lightbox)

Архив можно создать другим способом. Щелкните правой кнопкой мыши решение в **обозревателе решений** и выберите команду **Архивировать все** , которая выполняет построение решения и архивирует все проекты Xamarin, которые доступны для архивации:

[![Архивировать все](images/vs/09-archive-all-sml.png)](images/vs/09-archive-all.png#lightbox)

При выборе команд **Архивировать** и **Архивировать все** автоматически запускается **диспетчер архивов**. Чтобы запустить **диспетчер архивов** напрямую, выберите пункт меню **Сервис > Диспетчер архивов** :

[![Запуск диспетчера архивов](images/vs/10-launch-archive-manager-sml.png)](images/vs/10-launch-archive-manager.png#lightbox)

Архивы решения можно просмотреть в любое время. Для этого следует щелкнуть правой кнопкой мыши узел **Решение** и выбрать команду **Просмотр архивов** :

[![Просмотр архивов](images/vs/11-view-archives-sml.png)](images/vs/11-view-archives.png#lightbox)

### <a name="the-archive-manager"></a>Диспетчер архивов

В **диспетчере архивов** представлены область **Список решений** , область **Список архивов** , а также **панель сведений** :

[![Области диспетчера архивов](images/vs/12-archive-manager-detail-sml.png)](images/vs/12-archive-manager-detail.png#lightbox)

В области **Список решений** отображаются все решения, для которых существует хотя бы один архивированный проект. Область **Список решений** включает следующие разделы:

- **Текущее решение**  — отображает текущее решение. Обратите внимание, что эта область может быть пустой, если для текущего решения отсутствует архив.
- **Все архивы**  — отображает все решения с архивами.
- Текстовое поле **Поиск** (вверху) &ndash; фильтрует решения в списке **Все архивы** по введенной в текстовое поле строке поиска.

В области **Список архивов** отображается список всех архивов для выбранного решения. Область **Список архивов** включает следующие разделы:

- **Имя выбранного решения**  — отображает имя решения, выбранного в области **Список решений**. Все сведения, отображаемые в области **Список архивов** , относятся к выбранному решению.
- **Фильтр платформ**  — в этом поле можно отфильтровать список архивов по типу платформы (например, iOS или Android).
- **Элементы архива**  — содержит список архивов для выбранного решения. Для каждого элемента в списке отображаются имя проекта, дата создания и платформа. В процессе архивации или публикации также могут отображаться дополнительные сведения, например информация о ходе выполнения процесса.

В **панели сведений** представлена дополнительная информация об архиве. Кроме того, из нее пользователь может запустить рабочий процесс распространения или открыть папку, где было создано распространение. В разделе **Комментарии к сборке** можно добавить комментарии в архив.

### <a name="distribution"></a>Распределение

Если архивированная версия приложения готова к публикации, выберите архив в **диспетчере архивов** и нажмите кнопку **Распространить** :

[![Кнопка "Распространить"](images/vs/13-distribute-sml.png)](images/vs/13-distribute.png#lightbox)

В диалоговом окне **Канал распространения** приводятся сведения о приложении, информация о ходе выполнения процесса распространения, а также доступные каналы распространения. При первом запуске доступны два варианта:

[![Выбор канала распространения](images/vs/14-distribution-channel-sml.png)](images/vs/14-distribution-channel.png#lightbox)

Вы можете выбирать из следующих каналов распространения:

- **Специальный**  — сохраняет на диск подписанный пакет APK, который можно загружать на устройства Android в неопубликованном виде. В разделе [Подписывание пакета приложения](~/android/deploy-test/signing/index.md) вы узнаете, как создать удостоверение подписывания Android, как создать новый сертификат подписи для приложений Android и как опубликовать _специальную_ версию приложения на диск. Этот способ удобен для тестирования пакета APK.

- **Google Play**  — публикует пакет APK в Google Play. В разделе [Публикация в Google Play](~/android/deploy-test/publishing/publishing-to-google-play/index.md) вы узнаете, как подписать пакет APK и опубликовать его в магазине Google Play.

# <a name="visual-studio-for-mac"></a>[Visual Studio для Mac](#tab/macos)

Чтобы начать процесс публикации, выберите **Сборка > Архивировать для публикации** :

[![Архивация для публикации](images/xs/07-archive-for-publishing-sml.png)](images/xs/07-archive-for-publishing.png#lightbox)

Команда **Архивировать для публикации** выполняет построение проекта и объединяет его в файл архива. Команда **Архивировать все** позволяет архивировать все доступные для этого проекты в решении. Любая из этих команд автоматически запускает **диспетчер архивов** по завершении операции построения и объединения:

[![Представление архива](images/xs/08-archives-view-sml.png)](images/xs/08-archives-view.png#lightbox)

В этом примере в **диспетчере архивов** представлено только архивированное приложение **MyApp**. Обратите внимание, что в поле комментария можно добавить небольшой комментарий, который будет сохранен вместе с архивом. Чтобы опубликовать архивированную версию приложения Xamarin.Android, выберите приложение в **диспетчере архивов** и щелкните **Подписать и распространить** , как показано ниже. В открывшемся диалоговом окне **Подписать и распространить** будет представлено два варианта:

[![Подписать и распространить](images/xs/09-sign-and-distribute-sml.png)](images/xs/09-sign-and-distribute.png#lightbox)

Здесь можно выбрать канал распространения:

- **Специальный**  — сохраняет на диск подписанный пакет APK, который можно загружать на устройства Android в неопубликованном виде. В разделе [Подписывание пакета приложения](~/android/deploy-test/signing/index.md) вы узнаете, как создать удостоверение подписывания Android, как создать новый сертификат подписи для приложений Android и как опубликовать &ldquo;специальную&rdquo; версию приложения на диск. Этот способ удобен для тестирования пакета APK.

- **Google Play**  — публикует пакет APK в Google Play.
    В разделе [Публикация в Google Play](~/android/deploy-test/publishing/publishing-to-google-play/index.md) вы узнаете, как подписать пакет APK и опубликовать его в магазине Google Play.

-----

## <a name="related-links"></a>Связанные ссылки

- [Многоядерные устройства и Xamarin.Android](~/android/deploy-test/multicore-devices.md)
- [Архитектура процессора](~/android/app-fundamentals/cpu-architectures.md)
- [AOT](https://www.mono-project.com/docs/advanced/aot/)
- [Сокращение объемов кода и ресурсов](https://developer.android.com/tools/help/proguard.html)
- [Настройка приложений с помощью более чем 64 000 методов](https://developer.android.com/tools/building/multidex.html)
